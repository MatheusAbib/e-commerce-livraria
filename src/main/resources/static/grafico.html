<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Gráfico de Vendas | Dashboard Moderno</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/Grafico.css">
</head>
<body>
    <div id="header-container"></div>
<script>
  fetch('header.html')
    .then(response => response.text())
    .then(data => {
      document.getElementById('header-container').innerHTML = data;

      setTimeout(() => {
        const clienteLogado = JSON.parse(localStorage.getItem('clienteLogado'));

        if (clienteLogado) {
          const nomeSpan = document.getElementById('nome-cliente');
          if (nomeSpan) nomeSpan.textContent = clienteLogado.nome;

          const linksAdmin = [
            'link-log',
            'link-usuarios',
            'link-historico',
            'link-lucros',
            'link-livros',
            'link-pedidosADMIN'
          ];

          if (clienteLogado.perfil !== 'ADMIN') {
            linksAdmin.forEach(id => {
              const el = document.getElementById(id);
              if (el) el.style.display = 'none';
            });
          } else {
            const statusClienteLink = document.getElementById('link-status-cliente');
            if (statusClienteLink) statusClienteLink.style.display = 'none';
          }

        } else {
          const linksParaOcultar = [
            'link-log',
            'link-usuarios',
            'link-historico',
            'link-lucros',
            'link-livros',
            'link-pedidosADMIN',
            'link-status-cliente'
          ];
          linksParaOcultar.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = 'none';
          });
        }
      }, 50);
    });
</script>

    <div class="container">
        <h1><i class="fas fa-chart-line"></i> Histórico de Vendas</h1>
        
        <div class="filters">
            <select id="time-period">
                <option value="day">Por Dia</option>
                <option value="week">Por Semana</option>
                <option value="month" selected>Por Mês</option>
                <option value="year">Por Ano</option>
            </select>

            <select id="status-filter">
                <option value="todos" selected>Todos os Status</option>
                <option value="ENTREGUE">Entregue</option>
                <option value="TROCADO">Trocado</option>
                <option value="EM_PROCESSAMENTO">Em Processamento</option>
                <option value="CANCELADO">Cancelado</option>
                <option value="DEVOLUCAO">Devolução</option>
                <option value="DEVOLVIDO">Devolvido</option>
                <option value="EM_TRANSITO">Em Trânsito</option>
            </select>

            <select id="livros-filter" title="Filtrar por livro">
                <option value="" selected>Todos os Livros</option>
                <!-- Opções serão adicionadas dinamicamente -->
            </select>

            <select id="chart-type">
                <option value="line" selected>Gráfico de Linha</option>
                <option value="bar">Gráfico de Barras</option>
            </select>
            
            <input type="date" id="start-date" title="Data inicial">
            <input type="date" id="end-date" title="Data final">

            <button onclick="loadData()" id="refresh-btn">
                <i class="fas fa-check"></i> Aplicar Filtro
            </button>
        </div>
        
        <div class="chart-container">
            <canvas id="salesChart"></canvas>
        </div>
    </div>

    <script src="js/grafico.js"></script>
</body>
</html>
