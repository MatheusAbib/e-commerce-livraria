<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seu Carrinho</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <!-- Fontes -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="css/Carrinho.css">
</head>

<body>
   <header>
    <div class="container">
      <div class="d-flex justify-content-between align-items-center">
        <h1 style="font-size: 1.5rem;">Seu Carrinho</h1>
        <div class="header-actions">
          <a href="principal.html"><i class="bi bi-arrow-left me-1"></i> Voltar à loja</a>
          <div class="notificacao-icon-container">
            <div class="notificacao-icon" id="notificacao-icon">
              <i class="bi bi-bell-fill"></i>
              <span class="notificacao-badge" id="notificacao-badge" style="display: none;">0</span>
            </div>
            <div class="notificacao-dropdown" id="notificacao-dropdown" style="display: none;">
              <div class="notificacao-header">
                <h3>Notificações</h3>
                <button onclick="marcarTodasComoLidas()">Marcar todas como lidas</button>
              </div>
              <div class="notificacao-list" id="notificacao-list"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Conteúdo principal -->
  <main class="container my-5">
    <div class="cart-header">
      <h1>Meu Carrinho</h1>
      <p>Revise seus itens antes de finalizar a compra</p>
    </div>
    
    <div class="cart-steps">
      <div class="step completed">
        <div class="step-number">1</div>
        <div class="step-title">Carrinho</div>
      </div>
      <div class="step">
        <div class="step-number">2</div>
        <div class="step-title">Pagamento</div>
      </div>
      <div class="step">
        <div class="step-number">3</div>
        <div class="step-title">Confirmação</div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-lg-8">
        <!-- Tabela de itens do carrinho -->
        <div class="table-responsive">
          <table class="cart-table" id="cart-items">
            <thead>
              <tr>
                <th>Produto</th>
                <th>Preço</th>
                <th>Quantidade</th>
                <th>Subtotal</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="carrinho-itens" style="display: none;">
              <!-- Itens serão adicionados dinamicamente aqui -->
            </tbody>
          </table>
        </div>

        <!-- Itens expirados -->
        <div class="expired-items-container" id="expired-items-container" style="display: none;">
          <h4>Itens removidos por expiração</h4>
          <button class="carrinho-item-remover" onclick="limparItensExpirados()" title="Limpar todos os itens expirados">
            <i class="bi bi-trash"></i>
          </button>
          <div class="table-responsive">
            <table class="cart-table">
              <thead>
                <tr>
                  <th>Produto</th>
                  <th>Preço</th>
                  <th>Quantidade</th>
                  <th>Motivo</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="expired-items">
                <!-- Itens expirados serão adicionados aqui -->
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Carrinho vazio -->
        <div class="carrinho-vazio" id="carrinho-vazio">
          <i class="bi bi-cart-x"></i>
          <h3>Seu carrinho está vazio</h3>
          <p>Adicione produtos para continuar com sua compra</p>
          <a href="principal.html" class="btn-voltar">Voltar às Compras</a>
        </div>
        
        <!-- Ações do carrinho -->
        <div class="cart-actions" id="cart-actions" style="display: none;">
          <a href="principal.html" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left me-2"></i>Continuar Comprando
          </a>
          <button class="btn btn-outline-danger" onclick="limparCarrinho()">
            <i class="bi bi-trash me-2"></i>Limpar Carrinho
          </button>
        </div>
      </div>
      
      <!-- Resumo do pedido -->
      <div class="col-lg-4">
        <div class="carrinho-total" id="carrinho-total" style="display: none;">
          <h4>Resumo do Pedido</h4>
          
          <div class="summary-row">
            <span>Subtotal</span>
            <span id="subtotal">R$ 0,00</span>
          </div>
          <div class="summary-row">
            <span>Frete</span>
            <span id="frete">R$ 0,00</span>
          </div>
          <div class="summary-row" id="cupom-line" style="display: none;">
            <span>Desconto</span>
            <span class="text-success" id="valor-desconto">-R$ 0,00</span>
          </div>
          <div class="summary-row total">
            <span>Total</span>
            <span id="total">R$ 0,00</span>
          </div>
          
          <!-- Seção de Cupons - Modificada para múltiplos cupons -->
          <div class="cupom-container">
            <div class="d-flex gap-2 mb-2">
              <input type="text" id="input-cupom" class="form-control" placeholder="Digite seu cupom">
              <button class="btn-aplicar-cupom" onclick="aplicarCupom()">Aplicar</button>
              </button>
            </div>
            

            
            <!-- Cupons aplicados -->
            <div id="cupons-aplicados-container">
              <!-- Cupons aplicados serão adicionados aqui dinamicamente -->
            </div>
          </div>

          <!-- Endereço de entrega -->
          <div class="form-group">
            <label for="select-endereco">Escolha o endereço de entrega:</label>
            <select id="select-endereco" class="form-control" required>
              <option value="">-- Selecione um endereço --</option>
            </select>
            <div id="detalhes-endereco" class="detalhes-box" style="display:none;"></div>
          </div>

          <!-- Pagamento com cartões -->
          <div class="form-group">
            <label>Pagamento com múltiplos cartões:</label>
            <div id="cartoes-container">
              <!-- Cartões serão adicionados aqui dinamicamente -->
            </div>
            <button type="button" class="btn btn-sm btn-outline-primary mt-2" style="border-color: var(--primary-color); color: var(--primary-color)" onclick="adicionarCartao()">
              <i class="bi bi-plus-circle"></i> Adicionar outro cartão
            </button>
          </div>

          <!-- Resumo do pagamento -->
          <div id="resumo-pagamento" class="mt-3" style="display: none;">
            <h5>Resumo do Pagamento</h5>
            <div id="resumo-cartoes"></div>
            <div id="resumo-cupons"></div>
            <div class="summary-row total">
              <span>Total a pagar</span>
              <span id="total-pagamento">R$ 0,00</span>
            </div>
          </div>

          <!-- Botão finalizar compra -->
          <button class="btn-finalizar" id="btn-finalizar" onclick="finalizarCompra()">
            <i class="bi bi-credit-card me-2"></i>Finalizar Compra
          </button>
        </div>
      </div>
    </div>
  </main>

  <!-- Botão restaurar carrinho -->
  <button id="btn-restaurar-carrinho" style="display:none;" onclick="restaurarCarrinhoExpirado()">
    Restaurar pedido anterior
  </button>

  <!-- Notificação de sucesso -->
  <div id="notificacao-sucesso" class="notificacao-sucesso">
    <i class="bi bi-check-circle me-2"></i> Compra realizada com sucesso!
  </div>

  <!-- Temporizador do carrinho -->
  <div id="cart-timer" title="Tempo restante para finalizar a compra">
    <svg class="timer-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
      <path d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2zm1 11h-4v-2h3V7h2v6z"/>
    </svg>
    <div>
      <div class="timer-text" id="timer-display">-</div>
      <div class="timer-label">Tempo para <br>expirar o carrinho</div>
    </div>
  </div>

  <!-- Modal para Mensagens -->
  <div class="modal fade" id="cupomModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="cupomModalTitle">Informação do Cupom</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="cupomModalBody">
          <!-- Conteúdo será inserido dinamicamente -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Entendi</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
  
<script src="js/carrinho.js"></script>
  
</body>
</html>